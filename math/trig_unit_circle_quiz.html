<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìê Unit Circle & Trig - Practice Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0d0d0d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3), 0 0 60px rgba(233, 69, 96, 0.1);
            border: 1px solid rgba(233, 69, 96, 0.2);
        }

        h1 {
            text-align: center;
            color: #e94560;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 25px;
        }

        /* Flashcard Section */
        .flashcard-section {
            margin-bottom: 30px;
        }

        .flashcard-section h2 {
            text-align: center;
            color: #e94560;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .flashcard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
        }

        .flashcard {
            perspective: 1000px;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 110px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 10px;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            text-align: center;
            font-size: 0.8rem;
            line-height: 1.3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .flashcard-front {
            background: linear-gradient(135deg, #ffffff, #fff5f7);
            color: #e94560;
            font-weight: bold;
            border: 2px solid #e94560;
        }

        .flashcard-back {
            background: linear-gradient(135deg, #ffe6eb, #fff0f3);
            color: #333;
            transform: rotateY(180deg);
            border: 2px solid #e94560;
        }

        /* Progress Bar */
        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #e94560, #ff6b6b);
            height: 100%;
            transition: width 0.3s;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .timer {
            font-weight: bold;
            color: #e94560;
        }

        .timer.warning { color: #f39c12; }
        .timer.danger { color: #e74c3c; animation: pulse 0.5s infinite; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Question */
        .category {
            display: inline-block;
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-bottom: 15px;
        }

        .question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .option:hover {
            border-color: #e94560;
            background: #fff5f7;
        }

        .option.selected {
            border-color: #e94560;
            background: linear-gradient(135deg, #ffe6eb, #fff0f3);
        }

        .option.correct {
            border-color: #27ae60;
            background: #e8f8f0;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: #fde8e8;
        }

        /* Buttons */
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        /* Feedback */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .feedback.correct {
            background: #e8f8f0;
            border: 2px solid #27ae60;
            color: #27ae60;
        }

        .feedback.incorrect {
            background: #fde8e8;
            border: 2px solid #e74c3c;
            color: #e74c3c;
        }

        /* Results */
        .results {
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            color: white;
            box-shadow: 0 0 30px rgba(233, 69, 96, 0.4);
        }

        .score-number {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .score-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .results-message {
            font-size: 1.2rem;
            margin: 20px 0;
            color: #666;
        }

        /* Review Section */
        .review-section {
            background: linear-gradient(135deg, #fff5f7, #fff0f3);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
            border: 2px solid #e94560;
        }

        .review-section h3 {
            color: #e94560;
            margin-bottom: 15px;
            text-align: center;
        }

        .review-progress {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .review-question {
            font-size: 1.05rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .review-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .review-option {
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .review-option:hover {
            border-color: #e94560;
            background: #ffe6eb;
        }

        .review-option.selected {
            border-color: #e94560;
            background: #ffe6eb;
        }

        .review-option.correct {
            border-color: #4CAF50;
            background: #e8f5e9;
        }

        .review-option.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .review-option.reveal-correct {
            border-color: #4CAF50;
            background: #e8f5e9;
            animation: glow 0.5s ease-in-out;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px #4CAF50; }
            50% { box-shadow: 0 0 20px #4CAF50; }
        }

        .review-feedback {
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .review-feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .review-feedback.incorrect {
            background: #ffebee;
            color: #c62828;
        }

        .review-btn {
            display: block;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .review-btn-check {
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            color: white;
        }

        .review-btn-next {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }

        .review-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .review-score {
            text-align: center;
            padding: 20px;
        }

        .review-score h4 {
            color: #27ae60;
            margin-bottom: 10px;
        }

        .review-score p {
            color: #7f8c8d;
        }

        .hidden {
            display: none !important;
        }

        /* Restart separator */
        .restart-separator {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #ccc;
        }

        .restart-separator p {
            color: #7f8c8d;
            font-size: 0.85rem;
            margin-bottom: 10px;
            text-align: center;
        }

        /* Formula reference */
        .formula-card {
            background: #f8f9fa;
            border: 2px solid #e94560;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .formula-card h3 {
            color: #e94560;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .formula-card p {
            font-family: 'Courier New', monospace;
            margin: 5px 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <!-- Start Screen -->
            <div id="startScreen">
                <h1>üìê Unit Circle & Trig</h1>
                <p class="subtitle">Arc Length, Area, and Trigonometric Functions</p>

                <div class="formula-card">
                    <h3>üìù Key Formulas (Calculator Allowed!)</h3>
                    <p>‚Ä¢ Degrees ‚Üí Radians: multiply by <strong>œÄ/180</strong></p>
                    <p>‚Ä¢ Radians ‚Üí Degrees: multiply by <strong>180/œÄ</strong></p>
                    <p>‚Ä¢ Arc Length: <strong>s = (Œ∏/360) √ó 2œÄr</strong> or <strong>s = rŒ∏</strong> (radians)</p>
                    <p>‚Ä¢ Sector Area: <strong>A = (Œ∏/360) √ó œÄr¬≤</strong> or <strong>A = ¬Ωr¬≤Œ∏</strong> (radians)</p>
                </div>

                <div class="flashcard-section">
                    <h2>üìö Key Values to Know (Click to flip)</h2>
                    <div class="flashcard-grid" id="flashcardGrid"></div>
                </div>

                <div style="text-align: center; margin-bottom: 20px;">
                    <label style="display: inline-flex; align-items: center; gap: 10px; cursor: pointer; font-size: 1rem; color: #666;">
                        <input type="checkbox" id="timerToggle" checked style="width: 20px; height: 20px; cursor: pointer;">
                        <span>‚è±Ô∏è Enable Timer (2 min per question)</span>
                    </label>
                </div>

                <button class="btn btn-primary" onclick="startQuiz()">
                    üöÄ Start Practice Test
                </button>
            </div>

            <!-- Quiz Screen -->
            <div id="quizScreen" class="hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <div class="stats">
                    <span id="questionNum">Question 1 of 20</span>
                    <span class="timer" id="timer">‚è±Ô∏è 2:00</span>
                    <span id="scoreDisplay">Score: 0</span>
                </div>

                <div class="category" id="category"></div>
                <div class="question" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>

                <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()" disabled>
                    Submit Answer
                </button>
                <button class="btn btn-success hidden" id="nextBtn" onclick="nextQuestion()">
                    Next ‚Üí
                </button>

                <div class="feedback hidden" id="feedback"></div>
            </div>

            <!-- Results Screen -->
            <div id="resultsScreen" class="hidden">
                <div class="results">
                    <h1>üéâ Practice Test Complete!</h1>
                    <div class="score-circle">
                        <span class="score-number" id="finalScore">0%</span>
                        <span class="score-label">Correct</span>
                    </div>
                    <p class="results-message" id="resultsMessage"></p>

                    <div class="review-section hidden" id="reviewSection">
                        <h3 id="reviewHeader">üìù Let's Practice the Missed Questions!</h3>
                        <div class="review-progress" id="reviewProgress">Question 1 of 3</div>
                        <div class="review-question" id="reviewQuestion"></div>
                        <div class="review-options" id="reviewOptions"></div>
                        <div class="review-feedback hidden" id="reviewFeedback"></div>
                        <button class="review-btn review-btn-check" id="reviewCheckBtn" onclick="checkReviewAnswer()" disabled>Check Answer</button>
                        <button class="review-btn review-btn-next hidden" id="reviewNextBtn" onclick="nextReviewQuestion()">Next ‚Üí</button>
                        <div class="review-score hidden" id="reviewScore">
                            <h4 id="reviewCompleteHeader">üéâ Review Complete!</h4>
                            <p id="reviewScoreText"></p>
                        </div>
                    </div>

                    <div class="restart-separator">
                        <p>Ready for another round?</p>
                    </div>
                    <button class="btn btn-secondary" onclick="restartQuiz()">
                        üîÑ Try Again
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Flashcards - Key values to memorize
        const flashcards = [
            { front: "sin 0¬∞", back: "0" },
            { front: "sin 30¬∞", back: "1/2" },
            { front: "sin 45¬∞", back: "‚àö2/2" },
            { front: "sin 60¬∞", back: "‚àö3/2" },
            { front: "sin 90¬∞", back: "1" },
            { front: "cos 0¬∞", back: "1" },
            { front: "cos 30¬∞", back: "‚àö3/2" },
            { front: "cos 45¬∞", back: "‚àö2/2" },
            { front: "cos 60¬∞", back: "1/2" },
            { front: "cos 90¬∞", back: "0" },
            { front: "tan 45¬∞", back: "1" },
            { front: "tan 60¬∞", back: "‚àö3" },
            { front: "sec = ?", back: "1/cos" },
            { front: "csc = ?", back: "1/sin" },
            { front: "cot = ?", back: "1/tan" },
            { front: "œÄ radians = ?¬∞", back: "180¬∞" },
            { front: "œÄ/2 radians = ?¬∞", back: "90¬∞" },
            { front: "œÄ/6 radians = ?¬∞", back: "30¬∞" },
            { front: "Q1 signs", back: "(+, +)" },
            { front: "Q2 signs", back: "(‚àí, +)" },
            { front: "Q3 signs", back: "(‚àí, ‚àí)" },
            { front: "Q4 signs", back: "(+, ‚àí)" },
        ];

        // Question bank
        const questionBank = [
            // Quadrant questions
            {
                category: "Quadrants",
                question: "In which quadrant does the terminal side of 5œÄ/12 lie?",
                options: ["Quadrant II", "Quadrant I", "Quadrant III", "Quadrant IV"],
                correct: 1,
                explanation: "5œÄ/12 = 75¬∞, which is between 0¬∞ and 90¬∞ (Quadrant I)"
            },
            {
                category: "Quadrants",
                question: "In which quadrant does the terminal side of -13œÄ/6 lie?",
                options: ["Quadrant I", "Quadrant II", "Quadrant III", "Quadrant IV"],
                correct: 3,
                explanation: "-13œÄ/6 = -390¬∞. Add 360¬∞ twice: -390¬∞ + 720¬∞ = 330¬∞ (Quadrant IV)"
            },
            {
                category: "Quadrants",
                question: "In which quadrant does the terminal side of 570¬∞ lie?",
                options: ["Quadrant I", "Quadrant II", "Quadrant III", "Quadrant IV"],
                correct: 2,
                explanation: "570¬∞ - 360¬∞ = 210¬∞, which is between 180¬∞ and 270¬∞ (Quadrant III)"
            },
            {
                category: "Quadrants",
                question: "In which quadrant does the terminal side of 20¬∞ lie?",
                options: ["Quadrant III", "Quadrant IV", "Quadrant II", "Quadrant I"],
                correct: 3,
                explanation: "20¬∞ is between 0¬∞ and 90¬∞ (Quadrant I)"
            },
            {
                category: "Quadrants",
                question: "In which quadrant does the terminal side of 7œÄ/4 lie?",
                options: ["Quadrant IV", "Quadrant II", "Quadrant III", "Quadrant I"],
                correct: 0,
                explanation: "7œÄ/4 = 315¬∞, which is between 270¬∞ and 360¬∞ (Quadrant IV)"
            },
            // Exact trig values
            {
                category: "Trig Values",
                question: "What is sin 180¬∞?",
                options: ["1", "undefined", "0", "-1"],
                correct: 2,
                explanation: "At 180¬∞, the point on the unit circle is (-1, 0). sin = y-coordinate = 0"
            },
            {
                category: "Trig Values",
                question: "What is cos(3œÄ/4)?",
                options: ["‚àö2/2", "-1/2", "1/2", "-‚àö2/2"],
                correct: 3,
                explanation: "3œÄ/4 = 135¬∞ (Q2, reference angle 45¬∞). cos is negative in Q2: -‚àö2/2"
            },
            {
                category: "Trig Values",
                question: "What is sec(œÄ/3)?",
                options: ["1/2", "‚àö3/2", "2", "2‚àö3/3"],
                correct: 2,
                explanation: "sec = 1/cos. cos(œÄ/3) = cos(60¬∞) = 1/2. So sec = 1/(1/2) = 2"
            },
            {
                category: "Trig Values",
                question: "What is tan 270¬∞?",
                options: ["0", "undefined", "-1", "1"],
                correct: 1,
                explanation: "tan = sin/cos. At 270¬∞: sin = -1, cos = 0. Division by 0 is undefined"
            },
            {
                category: "Trig Values",
                question: "What is cot(11œÄ/6)?",
                options: ["‚àö3", "‚àö3/3", "-‚àö3/3", "-‚àö3"],
                correct: 3,
                explanation: "11œÄ/6 = 330¬∞ (Q4, ref 30¬∞). cot = cos/sin = (‚àö3/2)/(-1/2) = -‚àö3"
            },
            {
                category: "Trig Values",
                question: "What is sec 225¬∞?",
                options: ["‚àö2", "‚àö2/2", "-‚àö2", "-‚àö2/2"],
                correct: 2,
                explanation: "225¬∞ (Q3, ref 45¬∞). sec = 1/cos. cos(225¬∞) = -‚àö2/2. sec = -‚àö2"
            },
            {
                category: "Trig Values",
                question: "What is sin 90¬∞?",
                options: ["0", "-1", "undefined", "1"],
                correct: 3,
                explanation: "At 90¬∞, the point on the unit circle is (0, 1). sin = y-coordinate = 1"
            },
            // Degree to Radian conversions
            {
                category: "Conversions",
                question: "Convert -25¬∞ to radians:",
                options: ["-5œÄ/18", "-œÄ/25", "-5œÄ/36", "-25œÄ/180"],
                correct: 2,
                explanation: "-25¬∞ √ó (œÄ/180) = -25œÄ/180 = -5œÄ/36"
            },
            {
                category: "Conversions",
                question: "Convert 150¬∞ to radians:",
                options: ["3œÄ/4", "5œÄ/6", "2œÄ/3", "5œÄ/4"],
                correct: 1,
                explanation: "150¬∞ √ó (œÄ/180) = 150œÄ/180 = 5œÄ/6"
            },
            {
                category: "Conversions",
                question: "Convert 220¬∞ to radians:",
                options: ["22œÄ/18", "11œÄ/18", "220œÄ", "11œÄ/9"],
                correct: 3,
                explanation: "220¬∞ √ó (œÄ/180) = 220œÄ/180 = 11œÄ/9"
            },
            // Radian to Degree conversions
            {
                category: "Conversions",
                question: "Convert -11œÄ/3 to degrees:",
                options: ["-330¬∞", "-660¬∞", "-220¬∞", "-110¬∞"],
                correct: 1,
                explanation: "-11œÄ/3 √ó (180/œÄ) = -11 √ó 180/3 = -11 √ó 60 = -660¬∞"
            },
            {
                category: "Conversions",
                question: "Convert 4œÄ/9 to degrees:",
                options: ["45¬∞", "72¬∞", "90¬∞", "80¬∞"],
                correct: 3,
                explanation: "4œÄ/9 √ó (180/œÄ) = 4 √ó 180/9 = 4 √ó 20 = 80¬∞"
            },
            {
                category: "Conversions",
                question: "Convert 13œÄ/4 to degrees:",
                options: ["325¬∞", "585¬∞", "405¬∞", "520¬∞"],
                correct: 1,
                explanation: "13œÄ/4 √ó (180/œÄ) = 13 √ó 180/4 = 13 √ó 45 = 585¬∞"
            },
            // Arc Length problems
            {
                category: "Arc Length",
                question: "Find the arc length: radius = 12 in, angle = 45¬∞",
                options: ["6œÄ in", "3œÄ in", "9œÄ in", "12œÄ in"],
                correct: 1,
                explanation: "s = (45/360) √ó 2œÄ(12) = (1/8) √ó 24œÄ = 3œÄ in"
            },
            {
                category: "Arc Length",
                question: "Arc length = 8œÄ cm, radius = 6 cm. Find the angle:",
                options: ["120¬∞", "180¬∞", "240¬∞", "300¬∞"],
                correct: 2,
                explanation: "8œÄ = (Œ∏/360) √ó 2œÄ(6). Solve: 8œÄ = Œ∏ √ó 12œÄ/360. Œ∏ = 240¬∞"
            },
            {
                category: "Arc Length",
                question: "Find the arc length: radius = 20 cm, angle = 120¬∞",
                options: ["20œÄ/3 cm", "80œÄ/3 cm", "40œÄ/3 cm", "10œÄ cm"],
                correct: 2,
                explanation: "s = (120/360) √ó 2œÄ(20) = (1/3) √ó 40œÄ = 40œÄ/3 cm"
            },
            {
                category: "Arc Length",
                question: "Find the arc length: radius = 10 m, angle = 90¬∞",
                options: ["10œÄ m", "5œÄ m", "20œÄ m", "15œÄ m"],
                correct: 1,
                explanation: "s = (90/360) √ó 2œÄ(10) = (1/4) √ó 20œÄ = 5œÄ m"
            },
            // Sector Area problems
            {
                category: "Sector Area",
                question: "Find the sector area: radius = 15 cm, angle gives area 75œÄ cm¬≤. What is the angle?",
                options: ["90¬∞", "150¬∞", "120¬∞", "60¬∞"],
                correct: 2,
                explanation: "75œÄ = (Œ∏/360) √ó œÄ(15)¬≤ = (Œ∏/360) √ó 225œÄ. Solving: Œ∏ = 120¬∞"
            },
            {
                category: "Sector Area",
                question: "Find the radius if sector area = 8œÄ in¬≤ and angle = 45¬∞:",
                options: ["4 in", "8 in", "16 in", "2 in"],
                correct: 1,
                explanation: "8œÄ = (45/360) √ó œÄr¬≤ = (1/8) √ó œÄr¬≤. So r¬≤ = 64, r = 8 in"
            },
            {
                category: "Sector Area",
                question: "Find the sector area: radius = 16 in, angle = 120¬∞",
                options: ["128œÄ/3 in¬≤", "64œÄ in¬≤", "256œÄ in¬≤", "256œÄ/3 in¬≤"],
                correct: 3,
                explanation: "A = (120/360) √ó œÄ(16)¬≤ = (1/3) √ó 256œÄ = 256œÄ/3 in¬≤"
            },
            {
                category: "Sector Area",
                question: "Find the sector area: radius = 6 cm, angle = 60¬∞",
                options: ["12œÄ cm¬≤", "6œÄ cm¬≤", "36œÄ cm¬≤", "3œÄ cm¬≤"],
                correct: 1,
                explanation: "A = (60/360) √ó œÄ(6)¬≤ = (1/6) √ó 36œÄ = 6œÄ cm¬≤"
            }
        ];

        let questions = [];
        let currentQuestion = 0;
        let score = 0;
        let selectedOption = null;
        let missedQuestions = [];
        let timerInterval = null;
        let timeLeft = 120;
        let timerEnabled = true;

        // Review state
        let reviewQuestions = [];
        let currentReviewQuestion = 0;
        let reviewScore = 0;
        let selectedReviewOption = null;

        // Initialize flashcards
        function renderFlashcards() {
            const grid = document.getElementById('flashcardGrid');
            grid.innerHTML = flashcards.map((card, i) => `
                <div class="flashcard" onclick="flipCard(this)">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">${card.front}</div>
                        <div class="flashcard-back">${card.back}</div>
                    </div>
                </div>
            `).join('');
        }

        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        function shuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startQuiz() {
            questions = shuffle([...questionBank]).slice(0, 20);
            currentQuestion = 0;
            score = 0;
            missedQuestions = [];
            timerEnabled = document.getElementById('timerToggle').checked;
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQuestion];
            
            document.getElementById('progressFill').style.width = 
                `${((currentQuestion) / questions.length) * 100}%`;
            document.getElementById('questionNum').textContent = 
                `Question ${currentQuestion + 1} of ${questions.length}`;
            document.getElementById('scoreDisplay').textContent = `Score: ${score}`;
            document.getElementById('category').textContent = q.category;
            document.getElementById('questionText').innerHTML = q.question;
            
            const container = document.getElementById('optionsContainer');
            container.innerHTML = q.options.map((opt, i) => `
                <div class="option" data-index="${i}" onclick="selectOption(this, ${i})">
                    ${opt}
                </div>
            `).join('');
            
            selectedOption = null;
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('submitBtn').classList.remove('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
            document.getElementById('feedback').classList.add('hidden');
            
            startTimer();
        }

        function startTimer() {
            if (!timerEnabled) {
                document.getElementById('timer').textContent = '‚è±Ô∏è No Timer';
                document.getElementById('timer').style.opacity = '0.5';
                return;
            }
            
            document.getElementById('timer').style.opacity = '1';
            timeLeft = 120;
            updateTimerDisplay();
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    autoSubmit();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const timer = document.getElementById('timer');
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timer.textContent = `‚è±Ô∏è ${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            timer.classList.remove('warning', 'danger');
            if (timeLeft <= 20) timer.classList.add('danger');
            else if (timeLeft <= 40) timer.classList.add('warning');
        }

        function selectOption(element, index) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedOption = index;
            document.getElementById('submitBtn').disabled = false;
        }

        function autoSubmit() {
            if (selectedOption === null) {
                selectedOption = -1;
            }
            submitAnswer();
        }

        function submitAnswer() {
            clearInterval(timerInterval);
            
            const q = questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            
            options.forEach((opt, i) => {
                opt.style.pointerEvents = 'none';
                if (i === q.correct) {
                    opt.classList.add('correct');
                } else if (i === selectedOption && selectedOption !== q.correct) {
                    opt.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('hidden', 'correct', 'incorrect');
            
            if (selectedOption === q.correct) {
                score++;
                feedback.classList.add('correct');
                feedback.innerHTML = `<strong>‚úÖ Correct!</strong><br>${q.explanation}`;
            } else {
                feedback.classList.add('incorrect');
                feedback.innerHTML = `<strong>‚ùå Incorrect</strong><br>
                    The correct answer is: <strong>${q.options[q.correct]}</strong><br>
                    ${q.explanation}`;
                missedQuestions.push({
                    question: q.question,
                    correctAnswer: q.options[q.correct],
                    originalQuestion: q
                });
            }
            
            document.getElementById('scoreDisplay').textContent = `Score: ${score}`;
            document.getElementById('submitBtn').classList.add('hidden');
            document.getElementById('nextBtn').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion >= questions.length) {
                showResults();
            } else {
                renderQuestion();
            }
        }

        function showResults() {
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            
            const percentage = Math.round((score / questions.length) * 100);
            document.getElementById('finalScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 90) message = 'üåü Excellent! You\'re ready for that test!';
            else if (percentage >= 70) message = 'üëç Good job! Review the missed topics once more.';
            else if (percentage >= 50) message = 'üìö Keep studying! Focus on the areas you missed.';
            else message = 'üí™ Don\'t give up! Review the formulas and try again.';
            
            document.getElementById('resultsMessage').textContent = message;
            
            const reviewSection = document.getElementById('reviewSection');
            
            if (missedQuestions.length > 0) {
                reviewSection.classList.remove('hidden');
                startReviewMode();
            } else {
                reviewSection.classList.add('hidden');
            }
        }

        // Review Mode Functions
        function startReviewMode() {
            reviewQuestions = [...missedQuestions];
            currentReviewQuestion = 0;
            reviewScore = 0;
            selectedReviewOption = null;
            
            document.getElementById('reviewScore').classList.add('hidden');
            document.getElementById('reviewProgress').classList.remove('hidden');
            document.getElementById('reviewQuestion').classList.remove('hidden');
            document.getElementById('reviewOptions').classList.remove('hidden');
            document.getElementById('reviewCheckBtn').classList.remove('hidden');
            
            renderReviewQuestion();
        }

        function renderReviewQuestion() {
            const q = reviewQuestions[currentReviewQuestion];
            const originalQ = q.originalQuestion;
            
            document.getElementById('reviewProgress').textContent = 
                `Question ${currentReviewQuestion + 1} of ${reviewQuestions.length}`;
            
            document.getElementById('reviewQuestion').innerHTML = originalQ.question;
            
            const opts = originalQ.options;
            const correctAnswer = opts[originalQ.correct];
            
            let allOptions = shuffle([...opts]);
            
            const optionsContainer = document.getElementById('reviewOptions');
            optionsContainer.innerHTML = allOptions.map((opt, i) => `
                <div class="review-option" data-correct="${opt === correctAnswer}" onclick="selectReviewOption(${i})">${opt}</div>
            `).join('');
            
            selectedReviewOption = null;
            document.getElementById('reviewCheckBtn').disabled = true;
            document.getElementById('reviewCheckBtn').classList.remove('hidden');
            document.getElementById('reviewNextBtn').classList.add('hidden');
            document.getElementById('reviewFeedback').classList.add('hidden');
        }

        function selectReviewOption(index) {
            const options = document.querySelectorAll('.review-option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
            selectedReviewOption = index;
            document.getElementById('reviewCheckBtn').disabled = false;
        }

        function checkReviewAnswer() {
            const options = document.querySelectorAll('.review-option');
            const selectedOpt = options[selectedReviewOption];
            const isCorrect = selectedOpt.dataset.correct === 'true';
            
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.dataset.correct === 'true') {
                    opt.classList.add('reveal-correct');
                }
            });
            
            if (isCorrect) {
                selectedOpt.classList.add('correct');
                reviewScore++;
            } else {
                selectedOpt.classList.add('incorrect');
            }
            
            const feedback = document.getElementById('reviewFeedback');
            feedback.classList.remove('hidden', 'correct', 'incorrect');
            feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
            feedback.textContent = isCorrect ? '‚úÖ Great job! You got it!' : '‚ùå Not quite. The correct answer is highlighted.';
            
            document.getElementById('reviewCheckBtn').classList.add('hidden');
            document.getElementById('reviewNextBtn').classList.remove('hidden');
            
            document.getElementById('reviewNextBtn').textContent = 
                currentReviewQuestion < reviewQuestions.length - 1 ? 'Next Question ‚Üí' : 'See Results';
        }

        function nextReviewQuestion() {
            currentReviewQuestion++;
            if (currentReviewQuestion >= reviewQuestions.length) {
                showReviewResults();
            } else {
                renderReviewQuestion();
            }
        }

        function showReviewResults() {
            document.getElementById('reviewProgress').classList.add('hidden');
            document.getElementById('reviewQuestion').classList.add('hidden');
            document.getElementById('reviewOptions').classList.add('hidden');
            document.getElementById('reviewFeedback').classList.add('hidden');
            document.getElementById('reviewCheckBtn').classList.add('hidden');
            document.getElementById('reviewNextBtn').classList.add('hidden');
            
            const scoreDiv = document.getElementById('reviewScore');
            scoreDiv.classList.remove('hidden');
            
            const percentage = Math.round((reviewScore / reviewQuestions.length) * 100);
            document.getElementById('reviewScoreText').textContent = 
                `You got ${reviewScore} out of ${reviewQuestions.length} correct (${percentage}%) on the review!`;
        }

        function restartQuiz() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            document.getElementById('reviewSection').classList.add('hidden');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', renderFlashcards);
    </script>
</body>
</html>
